FROM node:20
WORKDIR /frontend
COPY package*.json yarn.lock ./
RUN corepack enable && corepack prepare yarn@stable --activate
RUN yarn install --immutable
COPY . .
ARG VITE_BACKEND_PORT
ARG VITE_BACKEND_ADMIN_EMAIL
ARG VITE_BACKEND_ADMIN_PASSWORD
ARG VITE_FRONTEND_PORT
ARG VITE_FRONTEND_HMR_HOST
ENV VITE_BACKEND_PORT=$VITE_BACKEND_PORT
ENV VITE_BACKEND_ADMIN_EMAIL=$VITE_BACKEND_ADMIN_EMAIL
ENV VITE_BACKEND_ADMIN_PASSWORD=$VITE_BACKEND_ADMIN_PASSWORD
ENV VITE_FRONTEND_PORT=$VITE_FRONTEND_PORT
ENV VITE_FRONTEND_HMR_HOST=$VITE_FRONTEND_HMR_HOST

EXPOSE 80

CMD ["sh", "-c", "yarn dev --host 0.0.0.0 --port 80"]
